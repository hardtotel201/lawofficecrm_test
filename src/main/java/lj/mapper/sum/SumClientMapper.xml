<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="lj.mapper.sum.SumClientMapper">

	<select id="sumClientsByMonth" parameterType="ClientInfo" resultType="SumByString">
		select DATE_FORMAT(registerTime,'%Y-%m') sumTitle, 
	           count(ClientInfo.clientId) as sumCount from ClientInfo
	    <if test=" isRightJoinClientAssign!=null and isRightJoinClientAssign==true ">
		   right join ClientAssign on ClientInfo.clientId=ClientAssign.clientId and ClientAssign.userId= #{loginUserId}
	    </if>
	    where 1=1
	    <if test=" registerTimeBegin!=null">
		  and ClientInfo.registerTime>=#{registerTimeBegin}
	    </if>
	    <if test=" registerTimeEnd!=null">
		  and #{registerTimeEnd}>ClientInfo.registerTime
	    </if>
	     group by sumTitle 
	     order by sumTitle
	</select>
	
</mapper>