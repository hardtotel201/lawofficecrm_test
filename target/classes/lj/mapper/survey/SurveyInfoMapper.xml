<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="lj.mapper.survey.SurveyInfoMapper">

  <select id="findAll" resultType="SurveyInfo">
    select * from SurveyInfo
  </select>
  
  <select id="findAllByRequestObj" parameterType="SurveyInfo" resultType="SurveyInfo">
    select SurveyInfo.*
    from SurveyInfo
    where 1=1
  </select>
  
   
 
  <select id="findAllPaged" parameterType="SurveyInfo" resultType="SurveyInfo">
    select SurveyInfo.*,UserInfo.userName as opUserName
    from SurveyInfo
    left join UserInfo on UserInfo.userId=SurveyInfo.opUserId
    where 1=1
    <if test="surveyTitle!=null and surveyTitle!='' ">
      and  SurveyInfo.surveyTitle like  '%${surveyTitle}%'
    </if>
    <if test="surveyType!=null and surveyType!='' ">
      and  SurveyInfo.surveyType like  '%${surveyType}%'
    </if>

    <if test="surveyMethod!=null and surveyMethod!='' ">
      and  SurveyInfo.surveyMethod like '%${surveyMethod}%'
    </if>
    <if test=" surveyTimeBegin!=null">
      and SurveyInfo.surveyTime>#{surveyTimeBegin}
    </if>
    <if test=" surveyTimeEnd!=null">
      and #{surveyTimeEnd}>SurveyInfo.surveyTime
    </if>
    order by ${sortField} ${sortType}
  </select>

  
  <select id="findById" parameterType="Long" resultType="SurveyInfo">
    select * from SurveyInfo where  surveyId=#{id}
  </select>
  
  <select id="findAllByField" parameterType="Map" resultType="SurveyInfo">
    select * from SurveyInfo where ${fieldName}=#{fieldValue}
  </select>

  <select id="getNowTime" resultType="java.util.Date">
    select now()
  </select>

  <insert id="insert" parameterType="SurveyInfo" flushCache="true" useGeneratedKeys="true" keyProperty="surveyId" >
      insert into SurveyInfo( surveyTitle, surveyType, surveyTime, surveyMethod, opTime, opUserId)
      values(#{surveyTitle,jdbcType=VARCHAR},#{surveyType,jdbcType=VARCHAR},#{surveyTime,jdbcType=TIMESTAMP},#{surveyMethod,jdbcType=VARCHAR},#{opTime,jdbcType=TIMESTAMP},#{opUserId,jdbcType=NUMERIC})
  </insert>

  <update id="update" parameterType="SurveyInfo" >
     update SurveyInfo 
     set  surveyTitle=#{surveyTitle,jdbcType=VARCHAR},  surveyType=#{surveyType,jdbcType=VARCHAR},  surveyTime=#{surveyTime,jdbcType=TIMESTAMP},  surveyMethod=#{surveyMethod,jdbcType=VARCHAR},  opTime=#{opTime,jdbcType=TIMESTAMP},  opUserId=#{opUserId,jdbcType=NUMERIC} 
     where surveyId=#{surveyId}
  </update>
  
  <delete id="deleteById" parameterType="long">
      delete from SurveyInfo where surveyId=#{id}
  </delete>
  
</mapper>